<!-- GIT -->
<section id="git" class="section text-center">
	<div style="padding-top:60px"></div>
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<h2 class="mkj-big-title">GIT</h2>
			</div>
		</div>
	</div>
</section>


<!-- MENU -->
<section id="resume" class="section  text-center">
	<div class="container">
		<div class="row">
			<div class="col-sm-4 text-left">
				<div class="mkj-menu"><a href="#initialisation" class="smoothScroll">Initialiser Git</a></div>
				<div class="mkj-menu"><a href="#local" class="smoothScroll">Git en local</a></div>
				<div class="mkj-menu"><a href="#branch" class="smoothScroll">Branches</a></div>
				<div class="mkj-menu"><a href="#remote" class="smoothScroll">Remotes</a></div>
			</div>
			<div class="col-sm-4 text-left">
				<div class="mkj-menu"><a href="#stash" class="smoothScroll">Stashes</a></div>
				<div class="mkj-menu"><a href="#audit" class="smoothScroll">Audits</a></div>
				<div class="mkj-menu"><a href="#ignore" class="smoothScroll">Exclure fichiers</a></div>
			</div>
			<div class="col-sm-4 text-left">
				<div class="mkj-menu"><a href="#master" class="smoothScroll">Rendre master</a></div>
				<div class="mkj-menu"><a href="#blockcommit" class="smoothScroll">Bloquer commit master</a></div>
				<div class="mkj-menu"><a href="#opensource" class="smoothScroll">Participer open source</a></div>
				<div class="mkj-menu"><a href="#gitftp" class="smoothScroll">Git-ftp</a></div>
			</div>
		</div>
	</div>
	<div id="initialisation">&nbsp;</div>
</section>


<!-- INITIALISATION -->
<section class="section  text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Initialiser Git</h3>
				<p>
					<span class="mkj-high">init</span> Initialise git sur le dossier en cours
					<br><span class="mkj-high">git init --bare</span> Initialise git en mode "bare", càd backup seulement (recommandé d'ajouter le suffix .git au folder)
				</p>
				<br>
				<p>
					Il existe aussi quelques configurations à faire, qui sont surtout requises pour plus tard avec les remotes.
					<br><span class="mkj-high">git config --global user_name "Njiva RABIO"</span> Change le credential
					<br><span class="mkj-high">git config --global user.email "njiva.rabio@vondrona.com"</span> Changement de l'adresse mail
				</p>
			</div>
		</div>
	</div>
	<div id="local">&nbsp;</div>
</section>


<!-- LOCAL -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Gérer Git en local</h3>
				<p>
					<span class="mkj-high">git add nomfichier.ext</span> Indexe un nouveau fichier pour versioning
					<br><span class="mkj-high">git add .</span> Raccourci pour indexer tous les fichiers
					<br><span class="mkj-high">git commit -a -m "Description du commit"</span> Committe les derniers changements avec indexation (-am fonctionne aussi)
					<br><span class="mkj-high">git log</span> Affiche l'historique des commits (cliquer Q pour quitter)
					<br><span class="mkj-high">git checkout {sha_du_commit}</span> Revenir au commit indiqué pour aperçu, sans annulation
					<br><span class="mkj-high">git checkout master</span> revient au dernier commit
					<br><span class="mkj-high">git status</span> statut du suivi git
					<br><span class="mkj-high">git reset --hard</span> annule tous les changements non committés
					<br><span class="mkj-high">git clean -fd</span> supprime les dossiers non committés
					<br><span class="mkj-high">git revert HEAD~3..HEAD</span>  annule les trois derniers commits
					<br><span class="mkj-high">git revert 444b1cff</span>  annule le commit 444b1cff
				</p>
			</div>
		</div>
	</div>
	<div id="branch">&nbsp;</div>
</section>


<!-- BRANCH -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Les branches</h3>
				<p>
					<span class="mkj-high">git branch</span>  liste les branchs, étoile devant celui en cours
					<br><span class="mkj-high">git branch {nouvelle-branche} </span> créé une nouvelle branche
					<br><span class="mkj-high">git branch -d {branche}</span>  supprime la branche "branche"
					<br><span class="mkj-high">git branch -D {branche}</span> supprimer la branche "branche" en forçant
					<br><span class="mkj-high">git branch -m {ancien-nom} {nouveau-nom}</span> renommer la branche "ancien-nom" en "nouveau-nom"
					<br><span class="mkj-high">git checkout nouvelle-branche</span> se placer dans une autre branche
					<br><span class="mkj-high">git checkout -b deuxieme-branche </span> créé la branche puis se placer dessus
					<br><span class="mkj-high">git merge brancheB </span>  ajouter dans la branche courante les mises à jour de brancheB
					<br><br><u><b>En cas de conflit durant le merge:</b></u>
					<br>Git va afficher le conflit. D'abord, commencer par ouvrir les fichiers indiqués et modifier les lignes en défaut. Durant le conflit, le statut de git sera "unmerged paths". Une fois tous les conflits résolus, il faut committer les changements. L'outil qui permet de voir les conflits (si il est installé) est lancé par la commande "git mergetool vimdiff" si il est installé.
				</p>
			</div>
		</div>
	</div>
	<div id="stash">&nbsp;</div>
</section>


<!-- STASH -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Les stashes</h3>
				<p>
					<span class="mkj-high">git stash </span> mettre les modifs de côté, sans les committer, pour passer à une autre branche
					<br><span class="mkj-high">git stash push -m "description stash" </span>stash-er avec une description
					<br><span class="mkj-high">git stash list </span>affiche les stashs
					<br><span class="mkj-high">git stash show 1 </span> affiche les détails de stash@{1}  ou mettre "stash@{1}" au lieu de 1 si ça ne fonctionne pas
					<br><span class="mkj-high">git stash pop </span> revenir sur la branche "stashée" et continuer le travail
					<br><span class="mkj-high">git stash apply</span> comme pour stash pop mais garde les modifs dans la pile (pop les supprime de la pile)
					<br><span class="mkj-high">git stash drop 1 </span> supprime le stash stash@{1}
				</p>
			</div>
		</div>
	</div>
	<div id="audit">&nbsp;</div>
</section>


<!-- AUDIT -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Audits</h3>
				<p>
					<span class="mkj-high">git diff</span> affiche les changements non-committés de tous les fichiers modifiés
					<br><span class="mkj-high">git diff --name-only head 6e542b</span> affiche les noms de fichiers modifiés entre head et le commit 6e542b
					<br><span class="mkj-high">git diff head 6e542b </span> affiche les détails des changements de tous les fichiers entre head et le commit 6e542b
					<br><span class="mkj-high">git blame fichier.ext </span> affiche ligne par ligne les modifs sur le fichier "fichier.ext", le début du sha est affiché
					<br><span class="mkj-high">git show {sha}</span> affiche les détails du commit {sha}
				</p>
			</div>
		</div>
	</div>
	<div id="remote">&nbsp;</div>
</section>


<!-- REMOTE -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Gérer les remotes</h3>
				<p>
					<span class="mkj-high">git remote</span> liste les remotes créés
					<br><span class="mkj-high">git remote -v </span> liste les remotes avec les urls
					<br><span class="mkj-high">git remote add origin {https://github.com/nrakotovao/repogit.git}</span> indique le remote nommé "origin" sur le path indiqué
					<br><span class="mkj-high">git remote add backup Z:\backup</span> indique un remote "backup" sur le path indiqué
					<br><span class="mkj-high">git remote add origin</span> supprime le remote origin existant
					<br><span class="mkj-high">git clone {https://github.com/facebook/react.git}</span> rapatrie un repo remote en local
					<br><span class="mkj-high">git push origin master </span> envoi les changements de la branche master sur "origin"  (add option -u)
					<br><span class="mkj-high">git push --force origin master</span> force un push de master vers origin (surtout lors création remote sur github)
					<br><span class="mkj-high">git pull origin master </span> rapatrie les changements de la branche "master" depuis le remote
					<br><span class="mkj-high">git remote set-url --add --push origin z:\local\backup </span> ajoute un second url au remote (attention: il faut réajouter l'url existant)
					<br><span class="mkj-high">git remote remove origin </span> supprime un remote
		</div>
	</div>
	<div id="ignore">&nbsp;</div>
</section>


<!-- IGNORE -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Exclure des fichiers</h3>
				<p>
					Créer le fichier <span class="mkj-high">.gitignore</span> et ajouter les fichiers et dossiers à ignorer dedans.
					<br>Le fichier .gitignore doit être tracké (ne pas inclure dans .gitignore).
					<br><span class="mkj-high">git rm --cached nom_fichier</span> supprime un fichier ignoré du cache, toujours commiter après
				</p>
			</div>
		</div>
	</div>
	<div id="blockcommit">&nbsp;</div>
</section>


<!-- BLOCKCOMMIT -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Bloquer les commits sur master</h3>
				<p>
					Ceci fonctionne pour un repository local seulement.
					<ol>
						<li>Aller dans dossier projet</li>
						<li>Créer fichier ".git/hooks/pre-commit" avec le contenu ci-après:
							<pre class="mkj-code">
#!/bin/sh
branch="$(git rev-parse --abbrev-ref HEAD)"
if [ "$branch" = "master" ]; then
echo "You can't commit directly to master branch"
exit 1
fi
</pre>
						</li>
						<li>Si en dehors de Windows, rendre le fichier executable: <span class="mkj-high">chmod +x .git/hooks/pre-commit</span></li>
					</ol>
				</p>
			</div>
		</div>
	</div>
	<div id="master">&nbsp;</div>
</section>


<!-- MASTER -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Faire d'une branche le master</h3>
				<p>
					Technique pour rendre une branche branch2 le master
					<ol>
						<li><span class="mkj-high">git checkout branch2</span></li>
						<li><span class="mkj-high">git merge --strategy=ours --no-commit master</span></li>
						<li><span class="mkj-high">git commit -m "Donner une message précise sur le merge qu'on va faire"</span></li>
						<li><span class="mkj-high">git checkout master</span></li>
						<li><span class="mkj-high">git merge branch2</span></li>
						<li><span class="mkj-high">git branch -d branch2</span></li>
					</ol>
				</p>
			</div>
		</div>
	</div>
	<div id="opensource">&nbsp;</div>
</section>


<!-- OPENSOURCE -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Participer à un projet open source</h3>
				<p>
					Faire un PR (pull request) consiste à proposer une modification sur un projet.
					<br>Les étapes pour participer à un projet github:
					<ol>
						<li>Faire un <span class="mkj-high">fork </span>du projet (prendre une copie d'une version) en cliquant sur le lien FORK dans github</li>
						<li>Rapatrier la copie du fork sur l'ordinateur local: <span class="mkj-high">git clone {path}</span></li>
						<li>Créer une nouvelle branche qui va contenir le changement et se placer dedans: <span class="mkj-high">git checkout -b my-new-feature</span></li>
						<li>Commiter avec un message clair (en anglais la plupart du temps): <span class="mkj-high">git commit -m "Added feature allowing users to comment"</span></li>
						<li>Envoyer la branche sur github: <span class="mkj-high">git push origin my-new-feature</span></li>
						<li>Proposer la modification dans github: 
							<ol>
								<li>Se placer sur votre fork</li>
								<li>Se placer sur la nouvelle branche</li>
								<li>Cliquer sur "Compare & pull request"</li>
							</ol>
						</li>
					</ol>
				</p>
			</div>
		</div>
	</div>
	<div id="gitftp">&nbsp;</div>
</section>


<!-- GIT-FTP -->
<section class="section text-center">
	<div class="container">
		<div class="row">
			<div class="col-md-12 text-left">
				<h3 class="mkj-title">Git-ftp</h3>
				<p>Git-ftp permet d'envoyer les fichiers modifiés directement en FTP. L'outil s'appuie sur les modifications de GIT pour détecter les fichiers modifiés. Il faut commiter avant d'envoyer les fichiers. Git-ftp refuse de faire un push si des modifications ne sont pas commitées.
				</p>
				Installation (sur Mac):
				<pre>
<i>//D'abord, vérifier la présence de command line tools:</i>
$ xcode-select -p

<i>//Installer l'outil</i>
$ brew install brotli
$ brew install git-ftp
</pre>
				<br>Configuration des scopes:
				<pre>
<i>//Configurer le scope quality</i>
$ git config git-ftp.quality.user quality@monsite.com
$ git config git-ftp.quality.url monsite.com  <i>//fourni par votre hébérgeur</i>
$ git config git-ftp.quality.password  MyPassword   <i>//éviter les caractères très spéciaux. Ex: ()</i>

<i>//Configurer le scope master</i>
$ git config git-ftp.master.user master@monsite.com
$ git config git-ftp.master.url monsite.com
$ git config git-ftp.master.password  MyMsPassword
</pre>
				<br>Premier usage des scopes:
				<pre>
<i>//Avant d'utiliser git-ftp, il faut indiquer le commit initial à partir duquel git-ftp fera ses comparaisons</i>
<i>//1. Aller sur la branche correspondante au scope et faire un catchup:</i>
$ git ftp catchup -s quality
<i>//Si le nom de la branche et le même que le nom du scope, on peut enlever le nom du scope:</i>
$ git ftp catchup -s

<i>//Faire pareil sur master aussi</i>

<i>//ATTENTION: le dernier commit devient la référence. Donc, s'il y a des fichiers dans les derniers commits qui nécessitent d'être uploadé au serveur, il faut faire un git reset --hard vers le dernier commit de référence.</i>
</pre>
				<br>Supprimer un scope:
				<pre>
$ git ftp remove-scope quality
</pre>
			</div>
		</div>
	</div>
	<div style="padding-bottom:40px"></div>
</section>
