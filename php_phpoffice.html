<!DOCTYPE html><html lang="fr"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="icon" type="image/x-icon" href="../images/favicon.ico" /><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="keywords" content=""><meta name="description" content=""><meta http-equiv='cache-control' content='no-cache'> <meta http-equiv='expires' content='0'> <meta http-equiv='pragma' content='no-cache'><title>NAOTY</title><link rel="stylesheet" href="css/bootstrap.min.css"><link rel="stylesheet" href="css/style.css"><link rel="stylesheet" href="css/font-awesome.min.css"></head><body id="top" data-spy="scroll" data-target=".navbar-collapse"><nav class="navbar navbar-default navbar-fixed-top navbar-expand-lg" role="navigation"><div class="navbar-header"><button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon icon-bar"></span><span class="icon icon-bar"></span><span class="icon icon-bar"></span></button><a href="index.html" class="navbar-brand" style="color:#000;">&nbsp;&nbsp;<i class="fa fa-caret-right" style="font-size:24px"></i>&nbsp;NAOTY</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right" id="menu-bar"></ul></div></nav><div id="main-contenu"></div>

<!-- PHPOFFICE -->
<section id="flutter" class="section text-center">
    <div style="padding-top:60px"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h2 class="mkj-big-title">PHPOFFICE</h2>
                <div style="margin-top:-24px"><img src="images/caret_up.png" width="20px"/> <a href="php.html">PHP</a></div>
            </div>
        </div>
    </div>
</section>


<!-- MENU -->
<section id="resume" class="section  text-center">
    <div class="container">
        <div class="row">
            <div class="col-sm-4 text-left">
                <div class="mkj-menu"><a href="#setup" class="smoothScroll">Mise en place</a></div>
            </div>
            <div class="col-sm-4 text-left">
                <div class="mkj-menu"><a href="#formats" class="smoothScroll">Formats</a></div>
            </div>
            <div class="col-sm-4 text-left">
                <div class="mkj-menu"><a href="#references" class="smoothScroll">References</a></div>
            </div>
        </div>
    </div>
    <div id="setup">&nbsp;</div>
</section>


<!-- SETUP -->
<section class="section  text-center">
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-left">
                <h3 class="mkj-title">MISE EN PLACE</h3>
                <p>
                    <pre>

</pre>
                </p>
            </div>
        </div>
    </div>
    <div id="formats">&nbsp;</div>
</section>


<!-- FORMATTAGES -->
<section class="section  text-center">
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-left">
                <h3 class="mkj-title">FORMATS</h3>
                    Alignements :
                    <pre>
<c>//formattage isolé</c>
$worksheet->getStyle("C1:G3")->getAlignment()->setHorizontal('right');  <c>//general, left, right, center, conterContinuous, justify, fill, distributed</c>
$worksheet->getStyle("C1:G3")->getAlignment()->setVertical('right');  <c>//bottom, top, center, justify, distributed</c>
</pre>
                <br>
                Nombres :
                <pre>
<c>//nombre entier avec séparateur</c>
$worksheet->getStyle("C2:G5")->getNumberFormat()->setFormatCode('#,##0');

<c>//récupérer format nombre depuis cellule puis l'appliquer sur d'autres cellules</c>
$format_nombre = $worksheet->getStyle('E1')->getNumberFormat()->getFormatCode();
$worksheet->getStyle("C5:G8")->getNumberFormat()->setFormatCode($format_nombre);
</pre>
                <br>
                Aller à la ligne:
                <pre>
<c>//attention: toujours utiliser " pour le texte afin que \n soit interprété</c>
$worksheet->setCellValue('H3', "Ce texte \nva aller à la ligne");
$worksheet->getStyle('H3')->getAlignment()->setWrapText(true);
</pre>
                <br>
                Dates :
                <pre>
<c>//ATTENTION: la cellule doit contenir un nombre 34512 pour la date et non un string</c>
$worksheet->setCellValue('D4', \PhpOffice\PhpSpreadsheet\Shared\Date::PHPToExcel($detail->daty));  <c>//convertir date en nombre</c>
$worksheet->getStyle("D4")->getNumberFormat()->setFormatCode('dd/mm/yyyy');  <c>//appliquer le formattage</c>
$worksheet->getStyle("D4")->getAlignment()->setHorizontal('left'); <c>//aligner à gauche si besoin</c>
</pre>
                <br>
                Bordures, font, background, alignement :
                <pre>
$worksheet->getStyle("A2:J8")->applyFromArray([
    'borders'=>[
        'bottom'=>[
            'borderStyle'=>'thin',  <c>// none, dashDot, dashDotDot, dashed, dotted, double, hair, medium, mediumDashDot, mediumDashDotDot, mediumDashed, slantDashDot, thick, thin</c>
            'color'=>['argb' => 'FF000000']
        ]
    ],
    'font'=>['bold'=>true],
    'fill'=>[
        'fillType'=>'solid',
        'color'=>['argb'=>'FFE7E7E7']
    ],
    'alignment' => [
        'vertical' => 'center',  <c>//bottom, top, center, justify, distributed</c>
        'horizontal' => 'right',  <c>//general, left, right, center, conterContinuous, justify, fill, distributed</c>
    ],
]);

<c>//On peut voir des codes utilisant des constantes comme:</c>
<c>\PhpOffice\PhpSpreadsheet\Style\Alignment::VERTICAL_CENTER</c>
<c>\PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER</c>
</pre>
                </p>
            </div>
        </div>
    </div>
    <div id="references">&nbsp;</div>
</section>


<!-- REFERENCES -->
<section class="section  text-center">
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-left">
                <h3 class="mkj-title">REFERENCES</h3>
                <p>
                    <a href="https://phpoffice.github.io/PhpSpreadsheet/" target="_blank">phpoffice.github.io</a>
                    <br>Le site officiel github de PHPOFFICE
                </p>
                <p>
                    <a href="https://phpspreadsheet.readthedocs.io" target="_blank">phpspreadsheet.readthedocs.io</a>
                    <br>La documentation READ THE DOCS de PHPOFFICE
                </p>
                <p>
                    <a href="https://github.com/PHPOffice/PHPWord" target="_blank">PHPWord</a>
                    <br>La page github du package PHPWord
                </p>
                <p>
                    <a href="https://phpword.readthedocs.io/en/latest/" target="_blank">phpword.readthedocs.io</a>
                    <br>La documentation READ THE DOCS de PHPWORD
                </p>
            </div>
        </div>
    </div>
    <div style="padding-bottom:40px"></div>
</section>


</div><footer class="text-center" style="background-color: transparent; border:none; padding-top: 8px;"><div class="container" style="background-color:#FFF; color:#555252; font-size:14px;"><div class="row" id="piedpage"><p>© Njaka RAKOTOVAO - 2024</p></div></div></footer><a href="#top" class="go-top"><i class="fa fa-chevron-up fa-1x"></i></a><script src="js/jquery.js"></script><script src="js/bootstrap.min.js"></script><script src="js/smoothscroll.js"></script><script src="js/jquery.flexslider.js"></script><script>$(document).ready(function () { document.querySelector('#piedpage').innerText = '(c) Njaka RAKOTOVAO - ' + (new Date()).getFullYear();$('.flexslider').flexslider({animation: "fade",directionNav: false});$(window).scroll(function () {if ($(this).scrollTop() > 200) {$('.go-top').fadeIn(200);} else {$('.go-top').fadeOut(200);}});$('.go-top').click(function (event) {event.preventDefault();$('html, body').animate({ scrollTop: 0 }, 300);})});</script></body></html>